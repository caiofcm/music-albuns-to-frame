!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e,n){"use strict";function r(){for(var t={},e=void 0,n=/([^&;=]+)=?([^&;]*)/g,r=window.location.hash.substring(1);e=n.exec(r);)t[e[1]]=decodeURIComponent(e[2]);return t}function o(){var t={headers:{Authorization:"'Bearer "+c.token+" '"}};return fetch(c.apiURL+"/me/top/tracks",t).then(function(t){return t.json()})}function i(){l.addEventListener("click",function(){window.location.href=f.URL})}function a(){return c}Object.defineProperty(e,"__esModule",{value:!0}),e.fetchUserTopTracks=e.getSpotifyAPIObject=e.fetchAPITokenFromBackEnd=void 0;var u=n(7),s=function(t){return t&&t.__esModule?t:{default:t}}(u),c=void 0,l=document.getElementById("trigger-auth"),f={URL:"https://music-albums-to-frame.herokuapp.com/login"};window.onload=function(){var t=r();t.access_token&&(c=new s.default({token:t.access_token}),o())},e.fetchAPITokenFromBackEnd=i,e.getSpotifyAPIObject=a,e.fetchUserTopTracks=o},function(t,e,n){"use strict";function r(t){t.classList.add("grab"),(0,u.setTimeout)(function(){c.appendChild(t),t.classList.remove("grab")},400)}function o(t){s.prepend(t)}function i(){return Array.from(c.children).map(function(t){return{urls:[t.getAttribute("data-album-640"),t.getAttribute("data-album-300"),t.querySelector("img").getAttribute("src")]}})}function a(){s.addEventListener("click",function(t){t.preventDefault(),r(t.target.closest(".list-item"))}),c.addEventListener("click",function(t){t.preventDefault(),o(t.target.closest(".list-item"))})}Object.defineProperty(e,"__esModule",{value:!0}),e.getSelectedPhotos=e.selectionOfAlbums=void 0;var u=n(14),s=document.getElementById("album-list"),c=document.getElementById("selected-box");e.selectionOfAlbums=a,e.getSelectedPhotos=i},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n(4),n(5);var o=n(6),i=r(o),a=n(1),u=n(0),s=n(17),c=r(s),l=n(20),f=r(l);console.log("Application started"),(0,u.fetchAPITokenFromBackEnd)(),(0,i.default)(),(0,a.selectionOfAlbums)(),(0,c.default)(),(0,f.default)()},function(t,e){},function(t,e){},function(t,e,n){"use strict";function r(){return!!m&&!!m.token}function o(t){return t.items.map(function(t){return t.album.artists=t.artists,t.album})}function i(){d.addEventListener("submit",function(t){m=(0,a.getSpotifyAPIObject)(),t.preventDefault(),r()?m.search.albums(f.value).then(function(t){return(0,u.renderAlbums)(t.albums.items,l)}):(console.log("Unauthorized!"),(0,c.default)("Unauthorized! Login to Spotify first."))}),h.addEventListener("click",function(t){t.preventDefault(),(0,a.fetchUserTopTracks)().then(function(t){return o(t)}).then(function(t){return(0,u.renderAlbums)(t,l)}).catch(function(t){(0,c.default)(t)})})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i;var a=n(0),u=n(12),s=n(13),c=function(t){return t&&t.__esModule?t:{default:t}}(s),l=document.getElementById("album-list"),f=document.getElementById("search-input"),d=document.getElementById("search-form"),h=document.getElementById("btn-track"),m=null},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(8),u=r(a),s=n(9),c=r(s),l=n(10),f=n(11),d=r(f),h=function(){function t(e){o(this,t),this.apiURL=e.apiURL||l.API_URL,this.token=e.token,this.album=c.default.bind(this)(),this.search=u.default.bind(this)()}return i(t,[{key:"request",value:function(t){var e={headers:{Authorization:"'Bearer "+this.token+"'"}};return fetch(t,e).then(d.default)}}]),t}();e.default=h},function(t,e,n){"use strict";function r(t,e){return this.request(this.apiURL+"/search?q="+e+"&type="+t)}function o(){return{artists:r.bind(this,"artist"),albums:r.bind(this,"album"),tracks:r.bind(this,"track"),playlists:r.bind(this,"playlist")}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";function r(){var t=this;return{getAlbum:function(e){return t.request(t.apiURL+"/albums/"+e)},getAlbums:function(e){return t.request(t.apiURL+"/albums/?ids="+e)},getTracks:function(e){return t.request(t.apiURL+"/albums/"+e+"/tracks")}}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.API_URL="https://api.spotify.com/v1"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return t.json()};e.default=r},function(t,e,n){"use strict";function r(t){return'\n    <div class="list-item" data-album-id="'+t.id+'"\n      data-album-640="'+t.images[0].url+'"\n      data-album-300="'+t.images[1].url+'">\n      <img src="'+t.images[2].url+'" alt="'+t.name+'" class="list-image">\n      <div class="list-description">\n        <p class="list-title">'+t.name+'</p>\n        <p class="list-subtitle">'+t.artists[0].name+"</p>\n      </div>\n    </div>"}function o(t){return 0===t.length?"No album was found":t.map(function(t){return r(t)}).join("")}function i(t,e){var n=o(t);e.innerHTML=n}Object.defineProperty(e,"__esModule",{value:!0}),e.singleItemMarkup=r,e.renderAlbums=i},function(t,e,n){"use strict";function r(t){return"<font> "+t+" </font>"}function o(t,e){var n={background:"#f44336",position:"fixed",bottom:"5%",left:"50%"};"danger"===e&&(n.background="#f44336"),"info"===e&&(n.background="blue"),"success"===e&&(n.background="green"),"warnning"===e&&(n.background="yellow"),Object.keys(n).forEach(function(t){i.style[t]=n[t]}),i.style.display="block",i.innerHTML=r(t),setTimeout(function(){i.style.display="none"},2e3)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var i=document.getElementById("alert-box")},function(t,e,n){(function(t){function r(t,e){this._id=t,this._clearFn=e}var o=Function.prototype.apply;e.setTimeout=function(){return new r(o.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(15),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(e,n(2))},function(t,e,n){(function(t,e){!function(t,n){"use strict";function r(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return c[s]=r,u(s),s++}function o(t){delete c[t]}function i(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}function a(t){if(l)setTimeout(a,0,t);else{var e=c[t];if(e){l=!0;try{i(e)}finally{o(t),l=!1}}}}if(!t.setImmediate){var u,s=1,c={},l=!1,f=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,"[object process]"==={}.toString.call(t.process)?function(){u=function(t){e.nextTick(function(){a(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&a(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),u=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){a(t.data)},u=function(e){t.port2.postMessage(e)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var t=f.documentElement;u=function(e){var n=f.createElement("script");n.onreadystatechange=function(){a(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){u=function(t){setTimeout(a,0,t)}}(),d.setImmediate=r,d.clearImmediate=o}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(2),n(16))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function i(t){if(f===clearTimeout)return clearTimeout(t);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function a(){p&&h&&(p=!1,h.length?m=h.concat(m):g=-1,m.length&&u())}function u(){if(!p){var t=o(a);p=!0;for(var e=m.length;e;){for(h=m,m=[];++g<e;)h&&h[g].run();g=-1,e=m.length}h=null,p=!1,i(t)}}function s(t,e){this.fun=t,this.array=e}function c(){}var l,f,d=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(t){f=r}}();var h,m=[],p=!1,g=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];m.push(new s(t,e)),1!==m.length||p||o(u)},s.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.prependListener=c,d.prependOnceListener=c,d.listeners=function(t){return[]},d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(t,e,n){"use strict";function r(){var t=(0,i.getSelectedPhotos)();$("#frame").empty().justifiedImages({images:t,rowHeight:u.value,maxRowHeight:s.value,thumbnailPath:function(t,e,n){var r=t.urls[1];return(e>600||n>600)&&(r=t.urls[0]),(e>250||n>250)&&(r=t.urls[1]),(e<100||n<100)&&(r=t.urls[2]),r},getSize:function(){return{width:1,height:1}},margin:c.value})}function o(){a.addEventListener("submit",function(t){t.preventDefault(),r()}),window.addEventListener("resize",function(){r()})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o,n(18),n(19);var i=n(1),a=document.getElementById("grid-form"),u=document.getElementById("minHeight"),s=document.getElementById("maxHeight"),c=document.getElementById("margin")},function(t,e){},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e,n,o){function i(e,n){this.element=e,this.$el=t(e),this._name=a,this.init(n)}var a="justifiedImages";i.prototype={defaults:{template:function(t){return'<div class="photo-container" style="height:'+t.displayHeight+"px;margin-right:"+t.marginRight+'px;"><img class="image-thumb" src="'+t.src+'" style="width:'+t.displayWidth+"px;height:"+t.displayHeight+'px;" ></div>'},appendBlocks:function(){return[]},rowHeight:150,maxRowHeight:350,handleResize:!1,margin:1,imageSelector:"image-thumb",imageContainer:"photo-container"},init:function(e){this.options=t.extend({},this.defaults,e),this.displayImages(),this.options.handleResize&&this.handleResize()},getBlockInRow:function(t){for(var e=this.options.appendBlocks(),n=0;n<e.length;n++){var r=e[n];if(r.rowNum===t)return r}},displayImages:function(){var e=this,n=[],r=0,o=0,i=this.options.images.length,a=this.options.images,u=[],s=0,c=this.options.appendBlocks(),l=this.$el.width(),f=parseInt(this.options.margin,10),d=this.$el,h=parseInt(this.options.rowHeight,10);t.each(this.options.images,function(t,r){var o=e.options.getSize(r),i=parseInt(o.width,10),a=parseInt(o.height,10);a!==h&&(i=Math.floor(i*(h/a))),s+=i,n.push(i)}),t.each(c,function(t,e){s+=e.width});for(var m=s/Math.ceil(s/l),p=0;o<i;){var g={width:0,photos:[]},v=0,y=this.getBlockInRow(u.length+1);for(y&&(g.width+=y.width,p+=y.width);p+n[o+v]/2<=m*(u.length+1)&&o+v<i;)p+=n[o+v],g.width+=n[o+v],g.photos.push({width:n[o+v],photo:a[o+v]}),v++;o+=v,u.push(g)}for(var w=0;w<u.length;w++){var g=u[w],b=!1;if(r=w+1,this.options.maxRows&&r>this.options.maxRows)break;w===u.length-1&&(b=!0),p=-1*f;var T=this.getBlockInRow(b?-1:r),P=l;T&&(P-=T.width,p=0);var E=P/g.width,v=g.photos.length,I=Math.min(Math.floor(h*E),parseInt(this.options.maxRowHeight,10));E=I/this.options.rowHeight;var k=t("<div/>",{class:"picrow"});k.height(I+f),d.append(k);for(var x="",A=0;A<g.photos.length;A++){var _=g.photos[A].photo,S=Math.floor(g.photos[A].width*E);p+=S+f,x+=this.renderPhoto(_,{src:this.options.thumbnailPath(_,S,I),width:S,height:I},!T&&A===g.photos.length-1)}if(""!==x){if(k.html(x),Math.abs(p-P)<.05*P){for(var L=0;p<P;){var R=k.find("."+this.options.imageContainer+":nth-child("+(L+1)+")"),M=R.find("."+this.options.imageSelector);M.width(M.width()+1),L=(L+1)%v,p++}for(L=0;p>P;){var O=k.find("."+this.options.imageContainer+":nth-child("+(L+1)+")"),j=O.find("."+this.options.imageSelector);j.width(j.width()-1),L=(L+1)%v,p--}}else if(P-p>.05*P)for(var B=P-p,U=0,C=k.find("."+this.options.imageContainer),H=0,D=0;D<C.length;D++){var N=B/C.length,F=C.eq(D),z=F.find("."+this.options.imageSelector),$=z.width(),q=z.height();w===C.length-1&&(N=B-U),z.width($+N),z.height(q/$*($+N)),H=(q-z.height())/2,z.css("margin-top",H),U+=N}T&&t("<div />",{class:this.options.imageContainer+" added-block",css:{width:T.width,height:I},html:T.html}).appendTo(k)}else k.remove()}},renderPhoto:function(e,n,r){var o,i={};return o=t.extend({},e,{src:n.src,displayWidth:n.width,displayHeight:n.height,marginRight:r?0:this.options.margin}),this.options.dataObject?i[this.options.dataObject]=o:i=o,this.options.template(i)},handleResize:function(){},refresh:function(e){this.options=t.extend({},this.defaults,e),this.$el.empty(),this.displayImages()}},t.fn[a]=function(e){var n,o=arguments;return this.each(function(){var u=t(this),s=t.data(this,"plugin_"+a),c="object"===(void 0===e?"undefined":r(e))&&e;s?"string"==typeof e?n=s[e].apply(s,Array.prototype.slice.call(o,1)):s.refresh.call(s,c):u.data("plugin_"+a,s=new i(this,c))}),n||this}}(jQuery,window,document)},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(){c.addEventListener("click",function(){s.default.toBlob(l).then(function(t){a.default.saveAs(t,"album_frame.png")}).catch(function(t){console.error("oops, something went wrong!",t)})})}Object.defineProperty(e,"__esModule",{value:!0}),e.default=o;var i=n(21),a=r(i),u=n(24),s=r(u),c=document.getElementById("btn-download"),l=document.getElementById("frame")},function(t,e,n){var r,o=o||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,n=function(){return t.URL||t.webkitURL||t},r=e.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,i=function(t){var e=new MouseEvent("click");t.dispatchEvent(e)},a=/constructor/i.test(t.HTMLElement)||t.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},c=function(t){var e=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};setTimeout(e,4e4)},l=function(t,e,n){e=[].concat(e);for(var r=e.length;r--;){var o=t["on"+e[r]];if("function"==typeof o)try{o.call(t,n||t)}catch(t){s(t)}}},f=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},d=function(e,s,d){d||(e=f(e));var h,m=this,p=e.type,g="application/octet-stream"===p,v=function(){l(m,"writestart progress write writeend".split(" "))};if(m.readyState=m.INIT,o)return h=n().createObjectURL(e),void setTimeout(function(){r.href=h,r.download=s,i(r),v(),c(h),m.readyState=m.DONE});!function(){if((u||g&&a)&&t.FileReader){var r=new FileReader;return r.onloadend=function(){var e=u?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,m.readyState=m.DONE,v()},r.readAsDataURL(e),void(m.readyState=m.INIT)}if(h||(h=n().createObjectURL(e)),g)t.location.href=h;else{t.open(h,"_blank")||(t.location.href=h)}m.readyState=m.DONE,v(),c(h)}()},h=d.prototype,m=function(t,e,n){return new d(t,e||t.name||"download",n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=f(t)),navigator.msSaveOrOpenBlob(t,e)}:(h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,m)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==t&&t.exports?t.exports.saveAs=o:null!==n(22)&&null!==n(23)&&void 0!==(r=function(){return o}.call(e,n,e,t))&&(t.exports=r)},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,n){!function(e){"use strict";function n(t,e){function n(t){return e.bgcolor&&(t.style.backgroundColor=e.bgcolor),e.width&&(t.style.width=e.width+"px"),e.height&&(t.style.height=e.height+"px"),e.style&&Object.keys(e.style).forEach(function(n){t.style[n]=e.style[n]}),t}return e=e||{},u(e),Promise.resolve(t).then(function(t){return c(t,e.filter,!0)}).then(l).then(f).then(n).then(function(n){return d(n,e.width||h.width(t),e.height||h.height(t))})}function r(t,e){return s(t,e||{}).then(function(e){return e.getContext("2d").getImageData(0,0,h.width(t),h.height(t)).data})}function o(t,e){return s(t,e||{}).then(function(t){return t.toDataURL()})}function i(t,e){return e=e||{},s(t,e).then(function(t){return t.toDataURL("image/jpeg",e.quality||1)})}function a(t,e){return s(t,e||{}).then(h.canvasToBlob)}function u(t){void 0===t.imagePlaceholder?y.impl.options.imagePlaceholder=v.imagePlaceholder:y.impl.options.imagePlaceholder=t.imagePlaceholder,void 0===t.cacheBust?y.impl.options.cacheBust=v.cacheBust:y.impl.options.cacheBust=t.cacheBust}function s(t,e){function r(t){var n=document.createElement("canvas");if(n.width=e.width||h.width(t),n.height=e.height||h.height(t),e.bgcolor){var r=n.getContext("2d");r.fillStyle=e.bgcolor,r.fillRect(0,0,n.width,n.height)}return n}return n(t,e).then(h.makeImage).then(h.delay(100)).then(function(e){var n=r(t);return n.getContext("2d").drawImage(e,0,0),n})}function c(t,e,n){function r(t){return t instanceof HTMLCanvasElement?h.makeImage(t.toDataURL()):t.cloneNode(!1)}function o(t,e,n){var r=t.childNodes;return 0===r.length?Promise.resolve(e):function(t,e,n){var r=Promise.resolve();return e.forEach(function(e){r=r.then(function(){return c(e,n)}).then(function(e){e&&t.appendChild(e)})}),r}(e,h.asArray(r),n).then(function(){return e})}function i(t,e){function n(){!function(t,e){t.cssText?e.cssText=t.cssText:function(t,e){h.asArray(t).forEach(function(n){e.setProperty(n,t.getPropertyValue(n),t.getPropertyPriority(n))})}(t,e)}(window.getComputedStyle(t),e.style)}function r(){function n(n){var r=window.getComputedStyle(t,n),o=r.getPropertyValue("content");if(""!==o&&"none"!==o){var i=h.uid();e.className=e.className+" "+i;var a=document.createElement("style");a.appendChild(function(t,e,n){var r="."+t+":"+e,o=n.cssText?function(t){var e=t.getPropertyValue("content");return t.cssText+" content: "+e+";"}(n):function(t){function e(e){return e+": "+t.getPropertyValue(e)+(t.getPropertyPriority(e)?" !important":"")}return h.asArray(t).map(e).join("; ")+";"}(n);return document.createTextNode(r+"{"+o+"}")}(i,n,r)),e.appendChild(a)}}[":before",":after"].forEach(function(t){n(t)})}function o(){t instanceof HTMLTextAreaElement&&(e.innerHTML=t.value),t instanceof HTMLInputElement&&e.setAttribute("value",t.value)}function i(){e instanceof SVGElement&&(e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e instanceof SVGRectElement&&["width","height"].forEach(function(t){var n=e.getAttribute(t);n&&e.style.setProperty(t,n)}))}return e instanceof Element?Promise.resolve().then(n).then(r).then(o).then(i).then(function(){return e}):e}return n||!e||e(t)?Promise.resolve(t).then(r).then(function(n){return o(t,n,e)}).then(function(e){return i(t,e)}):Promise.resolve()}function l(t){return p.resolveAll().then(function(e){var n=document.createElement("style");return t.appendChild(n),n.appendChild(document.createTextNode(e)),t})}function f(t){return g.inlineAll(t).then(function(){return t})}function d(t,e,n){return Promise.resolve(t).then(function(t){return t.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(t)}).then(h.escapeXhtml).then(function(t){return'<foreignObject x="0" y="0" width="100%" height="100%">'+t+"</foreignObject>"}).then(function(t){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+e+'" height="'+n+'">'+t+"</svg>"}).then(function(t){return"data:image/svg+xml;charset=utf-8,"+t})}var h=function(){function t(){var t="application/font-woff";return{woff:t,woff2:t,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function e(t){var e=/\.([^\.\/]*?)$/g.exec(t);return e?e[1]:""}function n(n){var r=e(n).toLowerCase();return t()[r]||""}function r(t){return-1!==t.search(/^(data:)/)}function o(t){return new Promise(function(e){for(var n=window.atob(t.toDataURL().split(",")[1]),r=n.length,o=new Uint8Array(r),i=0;i<r;i++)o[i]=n.charCodeAt(i);e(new Blob([o],{type:"image/png"}))})}function i(t){return t.toBlob?new Promise(function(e){t.toBlob(e)}):o(t)}function a(t,e){var n=document.implementation.createHTMLDocument(),r=n.createElement("base");n.head.appendChild(r);var o=n.createElement("a");return n.body.appendChild(o),r.href=e,o.href=t,o.href}function u(t){return new Promise(function(e,n){var r=new Image;r.onload=function(){e(r)},r.onerror=n,r.src=t})}function s(t){var e=3e4;return y.impl.options.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+(new Date).getTime()),new Promise(function(n){function r(){if(4===a.readyState){if(200!==a.status)return void(u?n(u):i("cannot fetch resource: "+t+", status: "+a.status));var e=new FileReader;e.onloadend=function(){var t=e.result.split(/,/)[1];n(t)},e.readAsDataURL(a.response)}}function o(){u?n(u):i("timeout of "+e+"ms occured while fetching resource: "+t)}function i(t){console.error(t),n("")}var a=new XMLHttpRequest;a.onreadystatechange=r,a.ontimeout=o,a.responseType="blob",a.timeout=e,a.open("GET",t,!0),a.send();var u;if(y.impl.options.imagePlaceholder){var s=y.impl.options.imagePlaceholder.split(/,/);s&&s[1]&&(u=s[1])}})}function c(t,e){return"data:"+e+";base64,"+t}function l(t){return t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function f(t){return function(e){return new Promise(function(n){setTimeout(function(){n(e)},t)})}}function d(t){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}function h(t){return t.replace(/#/g,"%23").replace(/\n/g,"%0A")}function m(t){var e=g(t,"border-left-width"),n=g(t,"border-right-width");return t.scrollWidth+e+n}function p(t){var e=g(t,"border-top-width"),n=g(t,"border-bottom-width");return t.scrollHeight+e+n}function g(t,e){var n=window.getComputedStyle(t).getPropertyValue(e);return parseFloat(n.replace("px",""))}return{escape:l,parseExtension:e,mimeType:n,dataAsUrl:c,isDataUrl:r,canvasToBlob:i,resolveUrl:a,getAndEncode:s,uid:function(){var t=0;return function(){return"u"+function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}()+t++}}(),delay:f,asArray:d,escapeXhtml:h,makeImage:u,width:m,height:p}}(),m=function(){function t(t){return-1!==t.search(o)}function e(t){for(var e,n=[];null!==(e=o.exec(t));)n.push(e[1]);return n.filter(function(t){return!h.isDataUrl(t)})}function n(t,e,n,r){function o(t){return new RegExp("(url\\(['\"]?)("+h.escape(t)+")(['\"]?\\))","g")}return Promise.resolve(e).then(function(t){return n?h.resolveUrl(t,n):t}).then(r||h.getAndEncode).then(function(t){return h.dataAsUrl(t,h.mimeType(e))}).then(function(n){return t.replace(o(e),"$1"+n+"$3")})}function r(r,o,i){return function(){return!t(r)}()?Promise.resolve(r):Promise.resolve(r).then(e).then(function(t){var e=Promise.resolve(r);return t.forEach(function(t){e=e.then(function(e){return n(e,t,o,i)})}),e})}var o=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:r,shouldProcess:t,impl:{readUrls:e,inline:n}}}(),p=function(){function t(){return e(document).then(function(t){return Promise.all(t.map(function(t){return t.resolve()}))}).then(function(t){return t.join("\n")})}function e(){function t(t){return t.filter(function(t){return t.type===CSSRule.FONT_FACE_RULE}).filter(function(t){return m.shouldProcess(t.style.getPropertyValue("src"))})}function e(t){var e=[];return t.forEach(function(t){try{h.asArray(t.cssRules||[]).forEach(e.push.bind(e))}catch(e){console.log("Error while reading CSS rules from "+t.href,e.toString())}}),e}function n(t){return{resolve:function(){var e=(t.parentStyleSheet||{}).href;return m.inlineAll(t.cssText,e)},src:function(){return t.style.getPropertyValue("src")}}}return Promise.resolve(h.asArray(document.styleSheets)).then(e).then(t).then(function(t){return t.map(n)})}return{resolveAll:t,impl:{readAll:e}}}(),g=function(){function t(t){function e(e){return h.isDataUrl(t.src)?Promise.resolve():Promise.resolve(t.src).then(e||h.getAndEncode).then(function(e){return h.dataAsUrl(e,h.mimeType(t.src))}).then(function(e){return new Promise(function(n,r){t.onload=n,t.onerror=r,t.src=e})})}return{inline:e}}function e(n){return n instanceof Element?function(t){var e=t.style.getPropertyValue("background");return e?m.inlineAll(e).then(function(e){t.style.setProperty("background",e,t.style.getPropertyPriority("background"))}).then(function(){return t}):Promise.resolve(t)}(n).then(function(){return n instanceof HTMLImageElement?t(n).inline():Promise.all(h.asArray(n.childNodes).map(function(t){return e(t)}))}):Promise.resolve(n)}return{inlineAll:e,impl:{newImage:t}}}(),v={imagePlaceholder:void 0,cacheBust:!1},y={toSvg:n,toPng:o,toJpeg:i,toBlob:a,toPixelData:r,impl:{fontFaces:p,images:g,util:h,inliner:m,options:{}}};t.exports=y}()}]);